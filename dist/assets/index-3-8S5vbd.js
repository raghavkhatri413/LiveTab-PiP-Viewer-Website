import{initializeApp as m}from"https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";import{getDatabase as x,ref as s,get as g,set as c,onValue as f}from"https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))t(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&t(a)}).observe(document,{childList:!0,subtree:!0});function e(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function t(r){if(r.ep)return;r.ep=!0;const i=e(r);fetch(r.href,i)}})();(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&e(i)}).observe(document,{childList:!0,subtree:!0});function o(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerPolicy&&(r.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?r.credentials="include":t.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function e(t){if(t.ep)return;t.ep=!0;const r=o(t);fetch(t.href,r)}})();const v={apiKey:"AIzaSyCn2-rTUJxnwp9Pi6jqYWu_xDMxbGl7MUg",authDomain:"live-tab-pip-viewer.firebaseapp.com",databaseURL:"https://live-tab-pip-viewer-default-rtdb.firebaseio.com",projectId:"live-tab-pip-viewer",storageBucket:"live-tab-pip-viewer.firebasestorage.app",messagingSenderId:"769065230447",appId:"1:769065230447:web:e0be917155de2935672d9a",measurementId:"G-3474L6ND6H"},y=m(v),l=x(y),u=document.getElementById("visitorCount"),d=document.getElementById("liveUsers");function p(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var o=Math.random()*16|0,e=n=="x"?o:o&3|8;return e.toString(16)})}function b(){const n=s(l,"visitorCount");let o=localStorage.getItem("deviceId");o||(o=p(),localStorage.setItem("deviceId",o),g(n).then(e=>{let t=e.exists()?e.val():0;c(n,t+1),console.log("Visitor count incremented:",t+1)}).catch(e=>{console.error("Error fetching/setting visitor count:",e)})),f(n,e=>{e.exists()?(u.innerText=`Total Visits: ${e.val()}`,console.log("Visitor count updated:",e.val())):(u.innerText="Total Visits: 0",console.log("No visitor count data."))},e=>{console.error("onValue error for visitor count:",e),u.innerText="Error loading visits."})}function h(){const n=s(l,"liveUsers"),o=p();c(s(l,`liveUsers/${o}`),!0).catch(e=>console.error("Error incrementing live users:",e)),f(n,e=>{if(e.exists()&&typeof e.val()=="object"){const t=Object.keys(e.val()).length;d.innerText=`Live Users: ${t}`,console.log("Live users loaded:",t)}else d.innerText="Live Users: 0",console.log("No live users data")},e=>{console.error("onValue error:",e),d.innerText="Error loading live users."}),window.addEventListener("beforeunload",()=>{c(s(l,`liveUsers/${o}`),null).catch(e=>console.error("Error decrementing live users:",e))}),window.addEventListener("unload",()=>{c(s(l,`liveUsers/${o}`),null).catch(e=>console.error("Error decrementing live users:",e))})}b();h();
